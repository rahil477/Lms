{% load i18n%}
<div id="top-navbar" class="py-1">
	<div class="container">
		<div class="nav-wrapper">

			<div class="toggle-btn" onclick="toggleSidebar()">
				<i class="fas fa-bars"></i>
			</div>

			<form class="form-header" action="{% url 'query' %}" method="GET">
				<input id="primary-search" class="form-control rounded-end-0" type="text" name="q"
					value="{{ request.GET.q }}"
					placeholder="{% trans 'Search All... #course, #program, #Quiz, #News, #Events' %}" required />
				<button class="btn btn-dark rounded-start-0" type="submit">
					<i class="fas fa-search"></i>
				</button>
			</form>

			<div class="dropdown mx-2">
				<div class="position-relative" type="button" data-bs-toggle="dropdown" aria-expanded="false">
					<i class="fas fa-bell fa-lg"></i>
					{% if unread_notifications_count > 0 %}
					<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
						style="font-size: 0.6rem;">
						{{ unread_notifications_count }}
					</span>
					{% endif %}
				</div>
				<div class="dropdown-menu dropdown-menu-end p-0" style="min-width: 20rem !important;">
					<div class="card-header bg-light d-flex justify-content-between align-items-center py-2 px-3">
						<span class="small font-weight-bold">{% trans 'Notifications' %}</span>
						{% if unread_notifications_count > 0 %}
						<a href="{% url 'mark_all_as_read' %}" class="small text-primary">{% trans 'Mark all as read'
							%}</a>
						{% endif %}
					</div>
					<div class="notification-list" style="max-height: 300px; overflow-y: auto;">
						{% for notification in unread_notifications %}
						<a href="{% url 'mark_as_read' notification.pk %}"
							class="dropdown-item py-2 px-3 border-bottom">
							<div class="d-flex flex-column">
								<span class="small font-weight-bold">{{ notification.verb }}</span>
								<span class="small text-muted">{{ notification.timestamp|timesince }} ago</span>
							</div>
						</a>
						{% empty %}
						<div class="py-3 text-center">
							<span class="small text-muted">{% trans 'No unread notifications' %}</span>
						</div>
						{% endfor %}
					</div>
					<div class="card-footer text-center py-2">
						<a href="{% url 'notifications' %}" class="small text-primary">{% trans 'View all' %}</a>
					</div>
				</div>
			</div>

			<div class="dropdown">
				<div class="avatar border border-2" type="button" data-bs-toggle="dropdown" aria-expanded="false">
					<img src="{{ request.user.picture.url }}">
				</div>
				<div class="dropdown-menu" style="min-width: 14rem !important;">
					<div class="d-flex flex-column align-items-center">
						<div class="avatar avatar-md border">
							<img src="{{ request.user.picture.url }}">
						</div>

						<p class="small text-muted text-center mb-0">
							{% trans 'Last login:' %} {{ request.user.last_login|date }}</p>
					</div>
					<hr>

					{% if request.user.is_lecturer or request.user.is_student %}
					<a class="dropdown-item" href="{% url 'user_course_list' %}"><i class="fas fa-book me-2"></i>{%
						trans 'My Courses' %}</a>
					{% endif %}

					{% if request.user.is_superuser %}
					<a class="dropdown-item" href="{% url 'admin_panel' %}"><i class="fas fa-user-tie me-2"></i>{% trans
						'Admin Panel' %}</a>
					{% endif %}

					<a class="dropdown-item" href="{% url 'profile' %}"><i class="fas fa-user me-2"></i>{% trans
						'Profile' %}</a>
					<a class="dropdown-item" href="{% url 'edit_profile' %}"><i class="fas fa-cog me-2"></i>{% trans
						'Setting' %}</a>
					<hr>
					<div style="display: flex; justify-content: center; align-items: center;">
						<a class="btn btn-secondary" href="{% url 'logout' %}">
							<i class="fas fa-sign-out-alt"></i> {% trans 'Signout' %}
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>